<div class="dashboard-container">
  <h1>Dashboard</h1>

  <div *ngIf="loading" class="loading">
    Loading messages...
  </div>

  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <div class="dashboard-section">
    <h2>Messages with Feedback</h2>
    <div *ngIf="messagesWithFeedback.length === 0" class="no-data">
      No messages with feedback found.
    </div>
    <div *ngIf="messagesWithFeedback.length > 0" class="messages-grid">
      <div class="message-card" *ngFor="let message of messagesWithFeedback">
        <div class="message-header">
          <span class="timestamp">{{ message.timestamp | date:'medium' }}</span>
          <span class="feedback-badge" [ngClass]="{'positive': message.feedBackPositive, 'negative': !message.feedBackPositive}">
            {{ message.feedBackPositive ? 'Positive' : 'Negative' }}
          </span>
        </div>
        <div class="message-content">
          <div class="question">
            <strong>Question:</strong> {{ message.userQuestion }}
          </div>
          <div class="response">
            <strong>Response:</strong> {{ message.reponse }}
          </div>
          <div class="feedback">
            <strong>Feedback:</strong> {{ message.feedback }}
          </div>
        </div>
        <div class="message-footer">
          <span class="topic-badge" [ngClass]="{'off-topic': message.horsSujet}">
            {{ message.horsSujet ? 'Off Topic' : 'On Topic' }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <div class="dashboard-section">
    <h2>All Messages</h2>
    <div *ngIf="messages.length === 0" class="no-data">
      No messages found.
    </div>
    <div *ngIf="messages.length > 0" class="messages-grid">
      <div class="message-card" *ngFor="let message of messages">
        <div class="message-header">
          <span class="timestamp">{{ message.timestamp | date:'medium' }}</span>
          <span *ngIf="message.feedBackPositive !== null" class="feedback-badge"
                [ngClass]="{'positive': message.feedBackPositive, 'negative': !message.feedBackPositive}">
            {{ message.feedBackPositive ? 'Positive' : 'Negative' }}
          </span>
        </div>
        <div class="message-content">
          <div class="question">
            <strong>Question:</strong> {{ message.userQuestion }}
          </div>
          <div class="response">
            <strong>Response:</strong> {{ message.reponse }}
          </div>
          <div *ngIf="message.feedback" class="feedback">
            <strong>Feedback:</strong> {{ message.feedback }}
          </div>
        </div>
        <div class="message-footer">
          <span class="topic-badge" [ngClass]="{'off-topic': message.horsSujet}">
            {{ message.horsSujet ? 'Off Topic' : 'On Topic' }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>
